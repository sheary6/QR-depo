<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>QR Designer</title>
  <style>
    body { margin: 0; font-family: Arial, sans-serif; background: #f4f6f8; }
    .wrap { display: grid; grid-template-columns: 400px 1fr; gap: 18px; padding: 18px; max-width: 1200px; margin: 0 auto; }
    .panel { background: #fff; border-radius: 12px; box-shadow: 0 6px 20px rgba(0,0,0,0.08); overflow: hidden; }
    .sidebar { padding: 0; }
    .accordion { border-bottom: 1px solid #e5e7eb; }
    .ac-head { display: flex; align-items: center; justify-content: space-between; padding: 14px 16px; cursor: pointer; font-weight: bold; }
    .head-actions { display: inline-flex; align-items: center; gap: 8px; }
    .ac-body { padding: 12px 16px; display: none; }
    .ac-body.open { display: block; }
    .ac-head span { color: #6b7280; }
    label { display: block; font-weight: bold; margin-top: 12px; }
    input[type="text"], textarea, select { width: 100%; padding: 10px 12px; margin-top: 6px; border: 1px solid #d1d5db; border-radius: 8px; height: 40px; box-sizing: border-box; }
    textarea { height: 100px; resize: none; }
    .row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    .color-row { display: grid; grid-template-columns: 1fr auto; gap: 8px; align-items: center; }
    .color-row input[type="color"] { width: 44px; height: 36px; padding: 0; border: none; background: transparent; }
    .btn { display: inline-block; padding: 12px 14px; border-radius: 10px; border: none; background: #111827; color: #fff; cursor: pointer; width: 100%; margin-top: 12px; }
    .btn:hover { filter: brightness(1.1); }
    .btn.secondary { background: #374151; }
    .preview { padding: 16px 18px 20px; display: grid; grid-template-rows: auto 1fr auto; align-items: start; justify-items: center; }
    .preview .canvas { width: min(90%, 720px); aspect-ratio: 1 / 1; background: #fff; display: grid; place-items: center; border: 1px dashed #e5e7eb; border-radius: 10px; padding: 10px; }
    #qrCanvas > svg, #qrCanvas > canvas { width: 100% !important; height: auto !important; }
    .tools { width: 100%; margin-top: 8px; display: grid; grid-template-columns: 1fr auto; gap: 10px; align-items: center; }
    .range { width: 100%; }
    .dl-row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; width: 100%; margin-top: 14px; }
    .hint { color: #6b7280; font-size: 12px; }
    .shape-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; margin-top: 10px; }
    .shape-grid button { border: 1px solid #d1d5db; border-radius: 8px; background: #fff; padding: 8px; cursor: pointer; }
    .mini-btn { padding: 6px 8px; border-radius: 6px; border: 1px solid #d1d5db; background: #f9fafb; color: #111827; cursor: pointer; font-size: 12px; }
    .mini-btn:hover { background: #eef2f7; }
    @media (max-width: 980px) {
      .wrap { grid-template-columns: 1fr; }
      .preview { order: -1; }
      .preview .canvas { width: min(95vw, 560px); }
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/qr-code-styling@1.6.0/lib/qr-code-styling.js"></script>
</head>
<body>
  <div class="wrap">
    <div class="panel sidebar">
      <div class="accordion">
        <div class="ac-head" data-target="#enter">
          ENTER CONTENT
          <span class="head-actions">
            <button class="mini-btn" id="switchToUrl" type="button">URL mode</button>
            <span>+</span>
          </span>
        </div>
        <div class="ac-body open" id="enter">
          <label>License Account No.</label>
          <input type="text" id="accountNo" value="L2540000675570">
          <label>Application No.</label>
          <input type="text" id="applicationNo" value="EL2540000687612">
          <label>Business Name</label>
          <input type="text" id="businessName" value="KOPI KENANGAN SDN BHD">
          <label>Premises Address</label>
          <textarea id="address">UNIT 1302, LEVEL 13, UPTOWN 2, NO. 2 JALAN SS21/37, DAMANSARA UPTOWN, 47400 PETALING JAYA</textarea>
          <div class="row">
            <div>
              <label>Start Date</label>
              <input type="text" id="startDate" value="01 January, 2025">
            </div>
            <div>
              <label>End Date</label>
              <input type="text" id="endDate" value="31 December, 2025">
            </div>
          </div>
          <label>Status</label>
          <input type="text" id="status" value="APPROVED">
          <button class="btn" id="generateBtn">Create QR Code</button>
        </div>
      </div>
      <div class="accordion" id="urlAccordion">
        <div class="ac-head" data-target="#urlBody">
          ENTER URL
          <span class="head-actions">
            <button class="mini-btn" id="switchToForm" type="button">Form mode</button>
            <span>+</span>
          </span>
        </div>
        <div class="ac-body" id="urlBody">
          <label>Short/Long URL</label>
          <input type="text" id="inputUrl" placeholder="https://example.com/your/path?query=...">
          <button class="btn" id="generateUrlBtn">Create QR Code</button>
        </div>
      </div>
      <div class="accordion">
        <div class="ac-head" data-target="#colors">SET COLORS <span>+</span></div>
        <div class="ac-body" id="colors">
          <div class="color-row">
            <div>
              <label>Foreground</label>
              <input type="text" id="fgHex" value="#000000">
            </div>
            <input type="color" id="fgPicker" value="#000000">
          </div>
          <div class="color-row">
            <div>
              <label>Background</label>
              <input type="text" id="bgHex" value="#ffffff">
            </div>
            <input type="color" id="bgPicker" value="#ffffff">
          </div>
        </div>
      </div>
      <div class="accordion">
        <div class="ac-head" data-target="#logo">ADD LOGO IMAGE <span>+</span></div>
        <div class="ac-body" id="logo">
          <input type="file" id="logoFile" accept="image/*">
          <div class="hint">PNG with transparent background recommended.</div>
        </div>
      </div>
      <div class="accordion">
        <div class="ac-head" data-target="#design">CUSTOMIZE DESIGN <span>+</span></div>
        <div class="ac-body" id="design">
          <label>Body Shape</label>
          <div class="shape-grid">
            <button data-dots="square">Square</button>
            <button data-dots="dots">Dots</button>
            <button data-dots="rounded">Rounded</button>
            <button data-dots="classy">Classy</button>
            <button data-dots="classy-rounded">Classy Rounded</button>
          </div>
          <label style="margin-top:12px;">Finder Corners</label>
          <div class="shape-grid">
            <button data-corners-square="square">Square</button>
            <button data-corners-square="dot">Dot</button>
            <button data-corners-square="extra-rounded">Extra Rounded</button>
          </div>
          <label style="margin-top:12px;">Presets</label>
          <div class="shape-grid">
            <button data-preset="classic">Classic QR</button>
            <button data-preset="rounded-eyes">Rounded Eyes</button>
          </div>
        </div>
      </div>
    </div>

    <div class="panel preview">
      <div class="tools">
        <div>
          <input class="range" id="sizeRange" type="range" min="300" max="1400" step="10" value="600">
        </div>
        <div class="hint"><span id="sizeLabel">600</span> x <span id="sizeLabelY">600</span> px</div>
      </div>
      <div class="canvas"><div id="qrCanvas"></div></div>
      <div class="dl-row">
        <button class="btn" id="downloadPng">Download PNG</button>
        <button class="btn secondary" id="downloadSvg">Download SVG</button>
      </div>
    </div>
  </div>

  <script>
    // Accordion behavior
    document.addEventListener('click', function(e){
      const head = e.target.closest('.ac-head');
      if (!head) return;
      const sel = head.getAttribute('data-target');
      const body = document.querySelector(sel);
      if (body) body.classList.toggle('open');
    });

    // Initialize QR styling
    let qr = null;
    let currentSize = 600;
    let currentData = ""; // stores either URL or content string
    let currentMode = 'form'; // 'form' | 'url'
    const canvasWrap = document.getElementById('qrCanvas');

    function collectData() {
      const accountNo = document.getElementById('accountNo').value.trim();
      const applicationNo = document.getElementById('applicationNo').value.trim();
      const businessName = document.getElementById('businessName').value.trim();
      const address = document.getElementById('address').value.trim();
      const startDate = document.getElementById('startDate').value.trim();
      const endDate = document.getElementById('endDate').value.trim();
      const status = document.getElementById('status').value.trim();
      return `${accountNo}|${applicationNo}|${businessName}|${address}|${startDate}|${endDate}|${status}`;
    }

    function buildOptions() {
      const fg = document.getElementById('fgHex').value || '#000000';
      const bg = document.getElementById('bgHex').value || '#ffffff';
      const margin = parseInt(canvasWrap.getAttribute('data-margin') || '10', 10);
      return {
        width: currentSize,
        height: currentSize,
        type: 'svg',
        data: currentData,
        qrOptions: { errorCorrectionLevel: 'H' },
        margin: margin,
        image: canvasWrap.getAttribute('data-logo') || undefined,
        imageOptions: { crossOrigin: 'anonymous', margin: 6, imageSize: 0.2 },
        dotsOptions: { type: canvasWrap.getAttribute('data-dots') || 'square', color: fg },
        backgroundOptions: { color: bg },
        cornersSquareOptions: { type: canvasWrap.getAttribute('data-corners-square') || 'square', color: fg },
        cornersDotOptions: { type: 'square', color: fg }
      };
    }

    function renderQR() {
      const options = buildOptions();
      if (!qr) { qr = new QRCodeStyling(options); qr.append(canvasWrap); }
      else { qr.update(options); }
    }

    // Generate buttons
    document.getElementById('generateBtn').addEventListener('click', function(){
      currentMode = 'form';
      currentData = collectData();
      renderQR();
    });
    document.getElementById('generateUrlBtn').addEventListener('click', function(){
      const url = document.getElementById('inputUrl').value.trim();
      if (!url) return;
      currentMode = 'url';
      currentData = url;
      renderQR();
    });

    // Colors sync
    const fgPicker = document.getElementById('fgPicker');
    const bgPicker = document.getElementById('bgPicker');
    fgPicker.addEventListener('input', function(){ document.getElementById('fgHex').value = this.value; renderQR(); });
    bgPicker.addEventListener('input', function(){ document.getElementById('bgHex').value = this.value; renderQR(); });
    document.getElementById('fgHex').addEventListener('input', function(){ fgPicker.value = this.value; renderQR(); });
    document.getElementById('bgHex').addEventListener('input', function(){ bgPicker.value = this.value; renderQR(); });

    // Shape selections
    document.querySelectorAll('[data-dots]').forEach(function(btn){
      btn.addEventListener('click', function(){ canvasWrap.setAttribute('data-dots', this.getAttribute('data-dots')); renderQR(); });
    });
    document.querySelectorAll('[data-corners-square]').forEach(function(btn){
      btn.addEventListener('click', function(){ canvasWrap.setAttribute('data-corners-square', this.getAttribute('data-corners-square')); renderQR(); });
    });

    // Presets
    document.querySelectorAll('[data-preset]').forEach(function(btn){
      btn.addEventListener('click', function(){
        const preset = this.getAttribute('data-preset');
        if (preset === 'classic') {
          canvasWrap.setAttribute('data-dots', 'square');
          canvasWrap.setAttribute('data-corners-square', 'square');
          canvasWrap.setAttribute('data-margin', '12');
        } else if (preset === 'rounded-eyes') {
          canvasWrap.setAttribute('data-dots', 'square');
          canvasWrap.setAttribute('data-corners-square', 'extra-rounded');
          canvasWrap.setAttribute('data-margin', '12');
        }
        renderQR();
      });
    });

    // Size range
    const sizeRange = document.getElementById('sizeRange');
    const sizeLabel = document.getElementById('sizeLabel');
    const sizeLabelY = document.getElementById('sizeLabelY');
    sizeRange.addEventListener('input', function(){ currentSize = parseInt(this.value, 10); sizeLabel.textContent = currentSize; sizeLabelY.textContent = currentSize; renderQR(); });

    // Logo upload
    document.getElementById('logoFile').addEventListener('change', function(e){
      const file = e.target.files && e.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = function(ev){ canvasWrap.setAttribute('data-logo', ev.target.result); renderQR(); };
      reader.readAsDataURL(file);
    });

    // Downloads
    document.getElementById('downloadPng').addEventListener('click', function(){ if (!qr) { currentData = collectData(); renderQR(); } qr.download({ name: 'qr-code', extension: 'png' }); });
    document.getElementById('downloadSvg').addEventListener('click', function(){ if (!qr) { currentData = collectData(); renderQR(); } qr.download({ name: 'qr-code', extension: 'svg' }); });

    // Header switches
    document.getElementById('switchToUrl').addEventListener('click', function(){
      document.querySelector('[data-target="#enter"]').nextElementSibling.classList.remove('open');
      document.querySelector('[data-target="#urlBody"]').nextElementSibling?.classList.add('open');
      document.getElementById('urlBody').classList.add('open');
    });
    document.getElementById('switchToForm').addEventListener('click', function(){
      document.getElementById('enter').classList.add('open');
      document.getElementById('urlBody').classList.remove('open');
    });
  </script>
</body>
</html>
